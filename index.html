<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trình chỉnh sửa ảnh AI</title>
    <link rel="stylesheet" href="index.css">
    <script type="importmap">
      {
        "imports": {
          "@google/genai": "https://esm.sh/@google/genai@1.0.0"
        }
      }
    </script>
<link rel="stylesheet" href="/index.css">
</head>
<body>
    <header>
      <h1>Trình chỉnh sửa ảnh AI</h1>
      <p>Tải ảnh lên, thêm trang phục hoặc đồ vật, và chỉnh sửa bằng sức mạnh của AI.</p>
    </header>
    <main class="main-container">
        <div class="controls">
            <div class="control-section">
                <h2 class="collapsible-header active">
                    <span>1. Tải ảnh gốc</span>
                    <svg class="caret-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
                </h2>
                <div class="collapsible-content">
                    <div id="upload-box">
                        <div id="image-preview-container"></div>
                        <div id="upload-placeholder">
                            <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21.2 15c.7-1.2 1-2.5.7-3.9-.6-2.4-3-4-5.4-4-1.8 0-3.3 1-4.1 2.4-1-.4-2.1-.5-3.2.1-1.8.8-2.9 2.6-2.9 4.6 0 2.7 2.2 4.9 4.9 4.9h9.1c1.9 0 3.6-1.3 4-3.2.3-1 .2-2.1-.1-3z"></path><path d="M12 12v9"></path><path d="m16 16-4-4-4 4"></path></svg>
                            <p><strong>Nhấp để tải lên</strong> hoặc kéo và thả</p>
                            <span class="placeholder-subtext">Hỗ trợ nhiều ảnh</span>
                        </div>
                    </div>
                    <input type="file" id="file-input" accept="image/*" hidden multiple>
                    <button id="upload-button">Chọn ảnh gốc</button>
                </div>
            </div>

            <div class="control-section">
                <h2 class="collapsible-header">
                    <span>2. Thêm trang phục/đồ vật (Tùy chọn)</span>
                    <svg class="caret-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
                </h2>
                <div class="collapsible-content collapsed">
                    <div id="object-upload-box" class="upload-box-single">
                        <div id="object-preview-container"></div>
                        <div id="object-upload-placeholder">
                            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><path d="M20.4 14.5L16 10l-4 4-4-4-5.4 6.5"></path></svg>
                            <p><strong>Tải lên đồ vật</strong></p>
                            <span class="placeholder-subtext">Tải lên 1 ảnh</span>
                        </div>
                    </div>
                    <input type="file" id="object-file-input" accept="image/*" hidden>
                    <button id="object-upload-button">Chọn ảnh đồ vật</button>
                </div>
            </div>
            
            <div class="control-section">
                <h2 class="collapsible-header active">
                    <span>3. Mô tả thay đổi</span>
                    <svg class="caret-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
                </h2>
                <div class="collapsible-content">
                    <textarea id="prompt-input" placeholder="Ví dụ: thay thế áo của người trong ảnh bằng trang phục đã tải lên ở trên.">Mở rộng ảnh này thành khung hình 9:16.</textarea>
                    
                    <div class="form-group">
                        <label for="version-count">Số phiên bản:</label>
                        <input type="number" id="version-count" value="1" min="1" max="4">
                    </div>

                    <div class="action-buttons">
                        <button id="generate-button" disabled>Tạo ảnh</button>
                    </div>
                    <div class="history-controls">
                        <button id="undo-button" disabled>Hoàn tác</button>
                        <button id="redo-button" disabled>Làm lại</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="results">
            <h2>Kết quả</h2>
            <div id="result-gallery">
                <p class="info-message">Kết quả sẽ được hiển thị ở đây.</p>
            </div>
        </div>
    </main>

    <!-- Image Preview Modal -->
    <div id="image-modal" class="modal-overlay">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <div id="modal-image-wrapper">
                <img id="modal-image" src="" alt="Xem trước ảnh kích thước đầy đủ">
            </div>
            <p id="modal-dimensions" class="image-dimensions"></p>
            <div id="modal-actions" class="modal-actions-container"></div>
        </div>
    </div>


    <script type="module" src="index.tsx"></script>
<script type="module" src="/index.tsx"></script>
</body>
</html>